// config/firebase.js
const admin = require("firebase-admin");
if (!admin.apps.length) {
  const decodedServiceAccount = JSON.parse(
    Buffer.from(
      "ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAia3dpa2dyb2Nlcmllcy04YTExZSIsCiAgInByaXZhdGVfa2V5X2lkIjogIjFhYWE0Y2QyMzI1MzRkNGUyMWVjZmFkMWQyZTUyMzdjN2EzYjVkZGQiLAogICJwcml2YXRlX2tleSI6ICItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQzN0RzZhd3krSWpvK0VcbnRUOFpYSFlOTWdIYktZRkZMSEFZMVg0d0F3azFac0NVcVVydUJNdTg4dTNFOFAzWDdyM2F0SlBHdXB2NXQwY1pcbk9pWVN0YW9LQ3g3Y3ZNTzc3S1JsL0liUHRYTnBHVHJqdE5zQjR0d2ZNdGpPR1JXc3o2MVc4VUs1Q2hnclhFQmZcblU4cDVPM21GK21UeG44UGd6L1RYOFRBWm1SalAxTVVpd2lMWkQrckxLVG9BYTdyQ2tmZVBrbWRaYUFCaExNeUdcbnVIZzBJb3NkUzBqM1JrdHBDclpCTlJWcHI3OU5MRG56YkM5SXNyam9vak5XMmJ1bmFTcTZ6T2hlOXFxUkY3WEFcbi80N1lZMGwxTVdJUzZ2Yk55UFlVYUJNdFJUSERkbUJibzZpR3h2MkpvYmxYbUs3eXkyakRHWDFCd0VHZUJvN1NcbkdpRHVOYWFOQWdNQkFBRUNnZ0VBR1FOZzRnSzhxS2ZjbzlHMzkwQ1BOR25BTmZLM1RzOW5yZ0gzemhyRHVMazJcbmRLZCtjOTFFVG9SM1dvOER5VkNSR2tQbk1USjhoV3B1ckdFdUNQTWlaWDZ4STVZeVFwYk1wYlJXT05iNGtYRmxcbmd0YS8wVWh0OTNPSmNMcWFxRzZZcUJOdXBkcFpneUhyQSsvWlRGdU1SdkZhcUVtOE5wS3FRSEx2UFRVSzIxVmVcbmdsU1haTCtzcFZHK0Y3bkpUOE9MeTUxWWIza3NpT1ltbE1DZ1ZrRFZMTVR0V1llbkFOd1U3czNzaFNablFiTGxcbmlRRFdSTWJDWnpQY09BRVJmUnR4bXRkNk1FaEFIT0EyOXlXSG5UVHFqNU1tQzE4WXB1dERIRk82a3RxakZ1dENcbmFicUhmK2ZnVW5VUkt5U3pkc1NnakExbVNyL1BkNVpMQkgrcm5TMS9rd0tCZ1FEc1JBUmM1STVKWEthVmErL2Zcbkk0SVRGVDNsUEdkeXJmUkJyaWkvbCs3TTdIbWNWM0lMSjB0UFhOWW8zOVE0TWNjbElLWUlyV2JEM3VTUDlWa3JcbnN6Tkswd2JNUnl6cTdUZmxLcmYwV3QxNlpSZFplc3V4SnpJMlZBQU4zaXJzM2Nxa2tIb2gyc2M4T1ZMSTJMY2lcbkM4SHhSN3JHdHZxQlppZ0EvYWNhZXE3Vjl3S0JnUURIRElaaVUwTUpKNFk3UUhrL0JsdStIZk1qaE5Kc0tVK1lcbkQwZEVLdmJ0QWM5eWt5WVpCblg2N1V3Ri8wdVdRR0pPWTZkUlEwdG9MZnNhNmg4NUg3Q0MwV2l6Sk1rZTFxK3FcbmdkNDgvUWJtQTRlNzgrOWNxSWNjOFdWdFkwT3lWMlZEL2Rzb1RiZnhHVTArUTNpcHROZ2RJeWV0MUxhdTdCRkJcbjhPTnNOb2cybXdLQmdRRFYwZ3ljd1IvZ1Z1QlAxRHBuR0N5TTlxbG9mODBqWlRqc0JDRE9uRUs2NUx4K2VFazJcbnZONFVPZkY3Vm00cVdTcGdlSGFxM2J0bVFwOVpoWEtvOE9uWHFybTVRQ1R2aTdZTlNTYm9GeC9mdUFOMHNJUU5cbmxHcUY3bW1LSTJsM3FwWE5idytJK2dWYmhJbGVTWHNiYmNhY2hRME03K1l3RzNMU3lyeGpZMm85S3dLQmdRQzNcbnFORGVMS0V2OHk0aHdjMmQzNG9MRTZ0aVhJMmppMEtMdFowMlFzWnZ6VG5TS0FBQkd6c0UrcXNvNVhTakFHazBcbmx6S3RBb0N6Y2FtK0hjUU5lelhzbnJnU2c2Q25PY1FBZWEvTGFsUlJLM1MwY2RHc0Z6d0Q4cUI1bkJ1OGxITTFcbmx5ZitPaWU4NkhHalA3STRORXNzSjJIWFBPd0szbnJWOHlTRWxwUjhmUUtCZ0h1VkFIT21BVmJ6L1B3ZnplcnFcbkh0ZUhQTStWYlc2a0xKYjhqV0FLS2s3elA1RnJPbEEreGtmcjJtdmhOamtDZUUvYVdROENQTnd6VEJkSFNiYUFcbkZTekVGZC9IdmRDZGdoUzc4QktOM3N6d0doTVNIdkM3YlhzM1dmeTZNckhiSmZLaUFLR2F0OWhYVVpwRjRDcHVcbnpBNWpqem8zamtUdm10d2VYOUJhSE5kWVxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLVxuIiwKICAiY2xpZW50X2VtYWlsIjogImZpcmViYXNlLWFkbWluc2RrLWVhNTlyQGt3aWtncm9jZXJpZXMtOGExMWUuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTA1NjE1NzU5NDIwMjkyNDM4ODM2IiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4iLAogICJhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwKICAiY2xpZW50X3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9maXJlYmFzZS1hZG1pbnNkay1lYTU5ciU0MGt3aWtncm9jZXJpZXMtOGExMWUuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJ1bml2ZXJzZV9kb21haW4iOiAiZ29vZ2xlYXBpcy5jb20iCn0K",
      "base64"
    ).toString("utf8")
  );

  admin.initializeApp({
    credential: admin.credential.cert(decodedServiceAccount),
    storageBucket: "kwikgroceries-8a11e.firebasestorage.app",
    projectId: "kwikgroceries-8a11e",
  });
}

const storage = admin.storage().bucket();

module.exports = {
  admin,
  storage,
};
