// config/firebase.js
const admin = require("firebase-admin");
if (!admin.apps.length) {
  const decodedServiceAccount = JSON.parse(
    Buffer.from(
      "ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAia3dpa2dyb2Nlcmllcy04YTExZSIsCiAgInByaXZhdGVfa2V5X2lkIjogImZhNzk2NWUxYjg4NjlkNTVlZGQwN2MwYmQ4OGM1MDY2MGZhOGJhMWIiLAogICJwcml2YXRlX2tleSI6ICItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRRG5qd1BtaVZqeVY2dDRcbjlUZnVsSnRvVUs0ZWtsVEY1dmt6RlhkM3hpWGJiUTFKTi9IVENFU3pvUEZWK1VERjdIWE1RY2Z6ZDFod3hhc2tcbjg2UFdvYjdTL1NsaEk0VkZiRDBUcjNXRU94WXNwYlRVUmJuellBcmpCZkVubmhoaitYK3JEemI1SCtqbXp0aEhcbmRMUnhaekNoeUVCTmhBVVBLeHVrSHA5eE56bWpvZHR6MUdJcW5JQnVHMEZIZE9Sb0pmZzZLc1JtVHFpMlpGYVdcblRhNmNydkp1bUpzS1VpcURBMm83aFIwVmVpbllNQjhXSjJKRjh2dDZTbHRxdGVyVE1QNkRBNDlIU09LczJ0TllcbkFmL293R3NPSGxoK3RyYld5NGc2SGFHRVkzdGJLVWlxaWRGUWZrTU9MYytVbTVFU1JBMCtIS0Z0UEhRYzUxSjFcbjg2NGNZZlJ2QWdNQkFBRUNnZ0VBUUluUjBuMVJkeW9NTnNoUjhJTW0xV28zUFhvWGVwa250NTh5RHdZQkl5ay9cbjNMcGxBaVo1ejM3NkJMWlY0VlJJZU1lVXpUemtQM280ZXpJVTVndHF2aStsU3RlMW0yWFJtQno5S2YrMTdIZTZcbjhMY0dYdGpUNy9hR0FqN0VHWWsrbGhURmc2WHJLZmxZdW9IQ2tTRHJvd3ZITUZPdGZVN01nMit0ak1hUm9CTkNcbjRreDdPeCt5N3R4WUdCV3pzTk44aDl2cTlOZmgvb1d2Q2xTeWNlYjF3TzdabnZPSkYwZHRiNTZUVXJsVnNYMkJcbjBjMnEzdDVoa3hVR1dvcmpLbjVlQ1pOZGlVQUpzRjBIak9UdUh5amF1V04zN0ZoMzdVYllJTThCNFk1aUNWSnJcbnh5RnBZTTllcnloMTVtWlpKcEc2S1NiUHl4NFVVY2pEeXoxSlEzVmhRUUtCZ1FEOFh0eHp1NUNUdEpkMk56S25cbi80U25QemxHYWdlemo2aWtvMFNUelBmY3VmMDN0UTVtemlGbFN0Qm84dkdXRG1qdGJ3ZmN5N3A2ZFk2NjU0eTdcbm1PWnd4bngvZ2lUbTlHUDVnd2h4eExpc2dpcWRibHNNQlFlMUdwYWZDUER4Ky9nZTVCbnd5Y2I5SVIydSszZTNcbjNsM3FlZlprbXNZQ1hubENGWlRwWEpJSDN3S0JnUURxNDRnMW90VlpYS2tzRWZHREYvRlMxdVBpMDlpSTY4TVpcbjZjb056QVlGMEZremJxVFZJVVM3VVhkTjQvWDVNS0hXMzJNUWxYb0JIOFlQNlJiaWhJV1Q3cEhreW9kQXp6YjRcbm8ySDBIUWw3M0FEeFRoTTd2VHhyUnF0d2R3UFNyTTBpelVtcUxDcjJBU1VGNXNDU1c0VjZOVXN5T2tuVC9lQUtcbmJ4bFVwVjdsY1FLQmdRQzd2d3A3NHJhczI3V3VFV1JURE1rdjd0MzZIMWs1WVE5UjQ5QlpzQ3RZL3RoOVArbkZcbjIyV0d5SUNCQXZOczhhMW5yYWtJdmxzdFRSVnd3RiszRkFtakxsWmlPWHlnZ0lGN2x0cUtZSklPYkF1dDhQSTBcbjMrMGE4dnZJdGtzaGlwVE16bDdwL2dKV1AvT29RSldRcVJIdkpPcURiNDBOS0NGSFkyelRxclZNdXdLQmdRRHBcbms3ZzR0aU41Q01jR0Z4WFdxakdGa2tIdHA0TFZyYlZIQ0pDd0phbjdrQk9VTEx2bllYenExWGxSVUphaTViU2FcbmEyd2s2cS8zZkRSR1VDRTh3bEhmS01lVi83eCtPMUZMOFpVUDN1dzJhakhaeEMwbUkrbDRPRDkxeURSYUJSSzlcblArMjROdEhGN3A5MWZlRVQ2Y1VUSVBvVkNaZXZJdS92RUVuZFBkSGZVUUtCZ1FEQTBTWHMvMlZxQjZYQUtQeGNcbkRoQzRWakxObkR2VTZBQVp3bDVuOVlwUUkveUpwVTNFYW9oU3poZ25XV1I1ZTh3ckxxNzRaNjJSb09DVEQ3eUdcbjVja200Zm9Dd2ZMcEZwdzk5WFd3VjhXU25kd3FsWWpVeERBZHpaS3VmVjJ5UWlwK3F1MWZZeXVZVE42NmZGdVdcbm95aWY1b05qaEF6U0V6RFB3ZFZFM0FTc0RnPT1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsCiAgImNsaWVudF9lbWFpbCI6ICJmaXJlYmFzZS1hZG1pbnNkay1lYTU5ckBrd2lrZ3JvY2VyaWVzLThhMTFlLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwKICAiY2xpZW50X2lkIjogIjEwNTYxNTc1OTQyMDI5MjQzODgzNiIsCiAgImF1dGhfdXJpIjogImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoIiwKICAidG9rZW5fdXJpIjogImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuIiwKICAiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsCiAgImNsaWVudF94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3JvYm90L3YxL21ldGFkYXRhL3g1MDkvZmlyZWJhc2UtYWRtaW5zZGstZWE1OXIlNDBrd2lrZ3JvY2VyaWVzLThhMTFlLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwKICAidW5pdmVyc2VfZG9tYWluIjogImdvb2dsZWFwaXMuY29tIgp9Cg==",
      "base64"
    ).toString("utf8")
  );

  admin.initializeApp({
    credential: admin.credential.cert(decodedServiceAccount),
    storageBucket: "kwikgroceries-8a11e.appspot.com",
    projectId: "kwikgroceries-8a11e",
  });
}

const storage = admin.storage().bucket();

module.exports = {
  admin,
  storage,
};
